function [spl,spu]=SmoothSpecCLim(ks,dego,frsm,prob)%function [spl,spu]=SmoothSpecCLim(ks,dego,frsm,prob)%Return vectors [spl,spu] of lower and upper confidence limits%for a spectrum that has been geometrically smoothed with SmoothSpec.%dego is the degrees of freedom of the lowest-freq estimate.%frsm is the smoothing parameter passed to Smoothspec, and prob is the%percent confidence.if nargin < 4     prob=95;endif frsm==0	cl=ConfLims(dego,prob);    l=cl(1);u=cl(2);    spl=l*ones(size(ks));spu=u*ones(size(ks));	return;endlk=log10(ks);lkr=max(lk)-min(lk);dlk=frsm*lkr;spl=zeros(size(ks));spu=spl;for c=1:length(ks)	ind=find(lk > lk(c) - dlk/2 & lk < lk(c) + dlk/2);	    cl=ConfLims(dego.*length(ind),prob);     spl(c)=cl(1);    spu(c)=cl(2);end